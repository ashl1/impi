#summary Структура базы данных

= Структура базы данных =

== Используемые сущности и их взаимосвязь ==

Проанализировав предметную область можно выделить сущности, которые являются общими и в той или иной мере присутствуют в каждом механизме обмена сообщениями.

Становится понятно, что главной сущностью является пользователь. Это человек, который отправляет или получает сообщения. Он представлен в виде анкеты человека, в которой находятся идентификационные данные человека, его контактные данные, описание, дополнительная или любая другая информация, связанная с персоной. Конкретная информация, находящаяся в анкете может отличаться между разными протоколами. У сообщения всегда присутствует отправитель, но получатель не обязателен, поскольку запись может быть опубликована, а значит доступна широкому кругу незарегистрированных лиц. Хранение списка получателей  будет описано ниже.

Также можно выделить так называемые чаты. Это виртуальная комната, в которой располагаются отправитель и получатели. Именно здесь как связь с пользователями будет хранится список получателей. Существуют также приватные чаты, где обмен сообщениями производится только между двумя пользователями, что не нарушает саму концепцию чата. Отправление сообщения SMS нескольким пользователям также может быть представлен как чат между отправителем и получателями.

У нас есть различные протоколы обмена сообщениями, соответственно Протокол является отдельной сущностью.

Существуют различные клиенты коротких сообщений, которые поддерживают обмен информацией в различных протоколах.

Каждый протокол подразумевает под собой регистрацию человека (пользователя) в системе. Пользователь может быть зарегистрирован в нескольких протоколах обмена сообщениями, и идентификационные данные у них могут быть разные. Таким образом один пользователь будет представлен в разных системах по разному. Отсюда появляется новая сущность — аккаунт. Пользователь представляет собой самого человека, а аккаунт является представлением человека в протоколе, клиенте. Данное определение не ограничивает одновременное использование только одного аккаунта пользователя в единственном протоколе. При этом аккаунт может быть один на одного пользователя у разных клиентов, поскольку аккаунт привязан к протоколу обмена сообщениями, а не к клиенту.

Таким образом получились следующие сущности:
 # Аккаунт,
 # Клиент,
 # Пользователь,
 # Протокол,
 # Сообщение,
 # Чат.

Между ними можно выделить следующие связи:

 # Аккаунта с Пользователем и Протоколом, поскольку Аккант представляет Пользователя в Протоколе.
 # Сообщения с Клиентом, Аккаунтом и Чатом, поскольку Сообщение находится в определённом чате и было отправлено с помощью определённого Клиента. Отправитель в данном случае будет представлен Аккаунтом. Также Сообщение связано с Сообщением-предком, если данное сообщение является ответвлением разговора, начиная с Сообщения-предка.

== ER модель ==

Ниже представлена ER-диаграмма базы данных в нотации Питера Чена, построенная на основе сущностей, описанных в Используемые сущности и их взаимосвязь.

http://code.google.com/p/impi/wiki/images/ER-DB.jpeg